# –§–∞–∑–∞ 2: Claude Code Integration

**–†–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏–π –ø–ª–∞–Ω**: [00-MARKDOWN_WORKFLOW_EXTENSION.md](../00-MARKDOWN_WORKFLOW_EXTENSION.md)

## –¶–µ–ª—å —Ñ–∞–∑—ã
–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å Claude Code –∞–≥–µ–Ω—Ç–∞–º–∏, —Ä–∞—Å—à–∏—Ä–∏–≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ AgentConnector –∏ SimpleOrchestrator –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ Claude Code –∫–æ–º–∞–Ω–¥–∞–º–∏.

## –í—Ö–æ–¥–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] –§–∞–∑–∞ 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞: markdown workflow'—ã –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –≤ JSON WorkflowDefinition
- [ ] IWorkflowEngine.ExecuteMarkdownWorkflowAsync() —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π AgentScheduler —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç —Å –±–∞–∑–æ–≤—ã–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏
- [ ] –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π SimpleOrchestrator –≥–æ—Ç–æ–≤ –∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é

## –ó–∞–¥–∞—á–∏ —Ñ–∞–∑—ã

### –ü—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ (–≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–¥–µ—Å—å)
- [ ] –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å Claude Code CLI –∫–æ–º–∞–Ω–¥—ã –∏ –∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (< 30 –º–∏–Ω—É—Ç)
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–º–∞–Ω–¥ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (< 30 –º–∏–Ω—É—Ç)
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è Claude Code —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ (< 30 –º–∏–Ω—É—Ç)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Claude Code –∞–≥–µ–Ω—Ç–æ–≤ (< 30 –º–∏–Ω—É—Ç)

### –°–ª–æ–∂–Ω—ã–µ –∑–∞–¥–∞—á–∏ (—Å—Å—ã–ª–∫–∏ –Ω–∞ –¥–æ—á–µ—Ä–Ω–∏–µ —Ñ–∞–π–ª—ã)
- [ ] [02-01-claude-code-connector.md](./02-Claude-Code-Integration/02-01-claude-code-connector.md) - ClaudeCodeAgentConnector –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
- [ ] [02-02-agent-connector-extension.md](./02-Claude-Code-Integration/02-02-agent-connector-extension.md) - –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ IAgentConnector –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
- [ ] [02-03-orchestrator-enhancement.md](./02-Claude-Code-Integration/02-03-orchestrator-enhancement.md) - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SimpleOrchestrator –¥–ª—è Claude Code
- [ ] [02-04-command-mapping.md](./02-Claude-Code-Integration/02-04-command-mapping.md) - Mapping markdown –∫–æ–º–∞–Ω–¥ –∫ Claude Code CLI
- [ ] [02-05-agent-scheduler-integration.md](./02-Claude-Code-Integration/02-05-agent-scheduler-integration.md) - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º AgentScheduler
- [ ] [02-06-real-agent-testing.md](./02-Claude-Code-Integration/02-06-real-agent-testing.md) - –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ Claude Code –∞–≥–µ–Ω—Ç–∞–º–∏
- [ ] [02-07-chat-integration.md](./02-Claude-Code-Integration/02-07-chat-integration.md) - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—Å–∫–æ–≥–æ —á–∞—Ç–∞ –≤ Blazor UI
- [ ] [02-08-context-management.md](./02-Claude-Code-Integration/02-08-context-management.md) - –ï–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞

## –í—ã—Ö–æ–¥–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã

### –ù–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- `ClaudeCodeAgentConnector` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω–Ω–µ–∫—Ç–æ—Ä –¥–ª—è Claude Code –∞–≥–µ–Ω—Ç–æ–≤
- `IClaudeCodeService` - —Å–µ—Ä–≤–∏—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å Claude Code CLI
- `ClaudeCodeCommandMapper` - mapping workflow –∫–æ–º–∞–Ω–¥ –∫ CLI –∫–æ–º–∞–Ω–¥–∞–º
- `ClaudeCodeConfiguration` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Claude Code –∞–≥–µ–Ω—Ç–æ–≤
- `ExecuteClaudeCodeCommandCommand` - –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è Claude Code –æ–ø–µ—Ä–∞—Ü–∏–π

### –†–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π `IAgentConnector` —Å –º–µ—Ç–æ–¥–∞–º–∏ –¥–ª—è Claude Code
- –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π `SimpleOrchestrator` —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Claude Code –∞–≥–µ–Ω—Ç–æ–≤
- –£–ª—É—á—à–µ–Ω–Ω—ã–π `AgentScheduler` —Å Claude Code —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- –ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ `AgentConfiguration`

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- `ClaudeCodeAgentFactory` - —Ñ–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Claude Code –∞–≥–µ–Ω—Ç–æ–≤
- `ClaudeCodeWorkflowExecutor` - –≤—ã–ø–æ–ª–Ω–∏—Ç–µ–ª—å workflow'–æ–≤ –¥–ª—è Claude Code
- `ClaudeCodeStatusMonitor` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–∞—Ç—É—Å–∞ Claude Code –∞–≥–µ–Ω—Ç–æ–≤

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ñ–∞–∑—ã
- [ ] –í—Å–µ –ø—Ä–æ—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –í—Å–µ –¥–æ—á–µ—Ä–Ω–∏–µ —Ñ–∞–π–ª—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã —Å –¥–µ—Ç–∞–ª—å–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏
- [ ] ClaudeCodeAgentConnector —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π AgentScheduler –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å Claude Code –∞–≥–µ–Ω—Ç–∞–º–∏
- [ ] SimpleOrchestrator –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å markdown workflow'—ã Claude Code –∞–≥–µ–Ω—Ç–∞–º
- [ ] –†–µ–∞–ª—å–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å Claude Code CLI —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –°—Ç–∞—Ç—É—Å—ã –∞–≥–µ–Ω—Ç–æ–≤ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ SignalR
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—Å–∫–∏–π —á–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Blazor UI (02-07)
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û**: –ï–¥–∏–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–∂–¥—É –∏–Ω—Å—Ç–∞–Ω—Å–∞–º–∏ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (02-08)
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å >= 85%
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ —ç—Ç–∞–ø—ã
- **–§–∞–∑–∞ 3 (Web Dashboard)** –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á 02-01 –∏ 02-03 (connector –∏ orchestrator)
- **–§–∞–∑–∞ 4 (Enhanced Features)** –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏ 02-06 (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∞–≥–µ–Ω—Ç–∞–º–∏) –¥–ª—è advanced —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏
- **–ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞** –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–π —Ñ–∞–∑—ã

## –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### Claude Code Command Mapping
```markdown
# Markdown Workflow Command
### Build Project
- **Type**: Task
- **Command**: dotnet build
- **Parameters**:
  - path: {{projectPath}}
  - configuration: Release

# Translated to Claude Code CLI
claude-code execute --command "dotnet build {{projectPath}} --configuration Release" --timeout 300
```

### AgentConnector —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
```csharp
public interface IAgentConnector
{
    // –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è
    Task<bool> PingAsync(string agentId);
    Task<TaskResult> ExecuteTaskAsync(string agentId, AgentTask task);

    // –ù–û–í–´–ï –º–µ—Ç–æ–¥—ã –¥–ª—è Claude Code
    Task<bool> IsClaudeCodeAgentAsync(string agentId);
    Task<ClaudeCodeExecutionResult> ExecuteClaudeCodeCommandAsync(string agentId, string command, Dictionary<string, object> parameters);
    Task<string> GetClaudeCodeVersionAsync(string agentId);
}
```

### SimpleOrchestrator –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
```csharp
public class SimpleOrchestrator
{
    // –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –¥–ª—è Claude Code workflow'–æ–≤
    public async Task<string> ExecuteMarkdownWorkflowAsync(string markdownFilePath, string targetAgentId)
    {
        // 1. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å markdown ‚Üí JSON workflow —á–µ—Ä–µ–∑ –§–∞–∑—É 1
        var workflow = await _markdownService.ConvertToWorkflowAsync(markdownFilePath);

        // 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–≥–µ–Ω—Ç - Claude Code
        var isClaudeCode = await _agentConnector.IsClaudeCodeAgentAsync(targetAgentId);

        // 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å —á–µ—Ä–µ–∑ Claude Code connector
        if (isClaudeCode)
        {
            return await _claudeCodeConnector.ExecuteWorkflowAsync(targetAgentId, workflow);
        }

        // 4. Fallback –∫ –æ–±—ã—á–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é
        return await _workflowEngine.ExecuteAsync(workflow, context);
    }
}
```

### AgentScheduler —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ
```csharp
public class AgentScheduler
{
    private async Task PingAgent(ConfiguredAgent agent)
    {
        try
        {
            // Existing logic remains
            var status = await CheckAgentStatus(agent);

            // NEW: Claude Code specific ping
            if (agent.Type == "claude-code")
            {
                status = await _claudeCodeConnector.PingClaudeCodeAgentAsync(agent.Id);
            }

            _orchestrator.UpdateAgentStatus(agent.Id, status);
        }
        catch (Exception ex)
        {
            _logger.LogError(ex, "Failed to ping agent: {AgentName}", agent.Name);
            _orchestrator.UpdateAgentStatus(agent.Id, AgentStatus.Error);
        }
    }
}
```

## –ö–æ–º–∞–Ω–¥—ã –∏ —Ö–µ–Ω–¥–ª–µ—Ä—ã

### ExecuteClaudeCodeCommandCommand
```csharp
public class ExecuteClaudeCodeCommandCommand : IRequest<ClaudeCodeExecutionResult>
{
    public string AgentId { get; set; }
    public string Command { get; set; }
    public Dictionary<string, object> Parameters { get; set; } = new();
    public TimeSpan Timeout { get; set; } = TimeSpan.FromMinutes(5);
    public string WorkflowId { get; set; }
}

public class ExecuteClaudeCodeCommandCommandHandler : IRequestHandler<ExecuteClaudeCodeCommandCommand, ClaudeCodeExecutionResult>
{
    private readonly IClaudeCodeService _claudeCodeService;
    private readonly ILogger<ExecuteClaudeCodeCommandCommandHandler> _logger;

    public async Task<ClaudeCodeExecutionResult> Handle(ExecuteClaudeCodeCommandCommand request, CancellationToken cancellationToken)
    {
        // TODO: Implement Claude Code command execution logic
        // 1. Validate agent is available
        // 2. Map command to CLI parameters
        // 3. Execute via Claude Code CLI
        // 4. Parse and return results
        throw new NotImplementedException();
    }
}
```

## –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∏—Å–∫–∏
- **Claude Code CLI –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** ‚Üí Retry –ª–æ–≥–∏–∫–∞ –∏ graceful fallback
- **Timeout —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** ‚Üí Configurable timeouts –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∫–æ–º–∞–Ω–¥
- **–ü—Ä–æ—Ü–µ—Å—Å management** ‚Üí Proper cleanup of Claude Code processes

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏
- **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º AgentScheduler** ‚Üí –¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
- **Performance impact** ‚Üí Async –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ proper resource management
- **Error handling** ‚Üí Comprehensive exception handling –∏ logging

---

**–°–¢–ê–¢–£–°**: –ì–æ—Ç–æ–≤ –∫ –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –≤ –¥–æ—á–µ—Ä–Ω–∏—Ö —Ñ–∞–π–ª–∞—Ö
**–°–õ–ï–î–£–Æ–©–ò–ï –î–ï–ô–°–¢–í–ò–Ø**: –°–æ–∑–¥–∞—Ç—å –¥–æ—á–µ—Ä–Ω–∏–µ —Ñ–∞–π–ª—ã —Å –º–∏–∫—Ä–æ-–¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π –∫–∞–∂–¥–æ–π —Å–ª–æ–∂–Ω–æ–π –∑–∞–¥–∞—á–∏ (‚â§30 –º–∏–Ω—É—Ç –Ω–∞ –∑–∞–¥–∞—á—É)